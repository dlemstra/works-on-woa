---
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";
type Props = CollectionEntry<"projects">;
const { slug, data } = Astro.props;
const { icon, name, categories, support } = data;

// get category data from references
const categoryPromises = categories.map(async (category) =>
  getEntry("categories", category.slug)
);
const categoriesData = await Promise.all(categoryPromises);
---

<div class="w-full lg:w-1/2 px-1">
  <li
    class="flex flex-row items-center bg-white bg-opacity-10 text-white mb-2 min-h-28 rounded-md"
  >
    <div class="p-4 h-full flex flex-col justify-center">
      <a href=`/projects/${slug}` class="cursor-pointer">
        <img src={`/icons/${icon}`} width="75px" class="max-h-14" />
      </a>
    </div>
    <div class="border-l border-gray-500 basis-full h-full">
      <a href=`/projects/${slug}` class="cursor-pointer">
        <h2 class="font-bold text-xl p-3">
          {name}
        </h2>
      </a>
      <div class="px-3 flex flex-col sm:flex-row gap-3 mb-3">
        <p>
          <b>Categories:&nbsp;</b>
          {
            categoriesData.map((category, index) => (
              <a href={`/${category.slug}/1`} class="inline">
                <span class="text-blue-400 underline">
                  {category.data.name}
                </span>
                {index === categoriesData.length - 1 ? "" : ", "}
              </a>
            ))
          }
        </p>
        <p>
          <b>Support:&nbsp;</b>
          <span>{support}</span>
        </p>
      </div>
    </div>
    <a
      class="p-5 text-5xl text-blue-500 cursor-pointer align-middle inline-block"
      href={`/projects/${slug}`}>Â»</a
    >
  </li>
</div>
